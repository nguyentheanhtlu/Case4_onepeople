<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Fashi Template" />
    <meta name="keywords" content="Fashi, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Fashi | Template</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css"
    />
    <!-- Css Styles -->
    <link
      rel="stylesheet"
      href="/product/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/font-awesome.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/themify-icons.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/elegant-icons.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/owl.carousel.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/nice-select.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/jquery-ui.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/slicknav.min.css"
      type="text/css"
    />
    <link rel="stylesheet" href="/product/css/style.css" type="text/css" />
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@9.17.2/dist/sweetalert2.min.css"
    />
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Header Section Begin -->
    <%- include('../header/header')%>
    <!-- Header End -->

    <!-- Breadcrumb Section Begin -->
    <div class="breacrumb-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="breadcrumb-text">
              <a href="#"><i class="fa fa-home"></i> Home</a>
              <span>Login</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Breadcrumb Form Section Begin -->

    <!-- Register Section Begin -->
    <div class="register-login-section spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 offset-lg-3">
            <div class="login-form">
              <h2>Login</h2>
              <div style="text-align: center">
                <a href="/auth/facebook"
                  ><ion-icon
                    style="font-size: 80px"
                    name="logo-facebook"
                  ></ion-icon
                ></a>
                <a href="/auth/google">
                  <ion-icon
                    style="font-size: 80px"
                    name="logo-google"
                  ></ion-icon>
                </a>
              </div>
              <form id="login-form" enctype="multipart/form-data">
                <div class="group-input">
                  <label for="email">Email address *</label>
                  <input type="text" id="email" name="email" />
                </div>
                <div class="group-input">
                  <label for="password">Password *</label>
                  <input type="password" id="password" name="password" />
                </div>
                <div class="group-input gi-check">
                  <div class="gi-more">
                    <label for="save-pass">
                      Save Password
                      <input type="checkbox" id="save-pass" />
                      <span class="checkmark"></span>
                    </label>
                    <a href="#" class="forget-pass">Forget your Password</a>
                  </div>
                </div>
                <button type="submit" class="site-btn login-btn">
                  Sign In
                </button>
              </form>
              <div class="switch-login">
                <a href="/auth/register" class="or-login"
                  >Or Create An Account</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Register Form Section End -->

    <!-- Partner Logo Section Begin -->
    <div class="partner-logo">
      <div class="container">
        <div class="logo-carousel owl-carousel">
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-1.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-2.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-3.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-4.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-5.png" alt="" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Partner Logo Section End -->

    <!-- Footer Section Begin -->
    <%- include('../footer/footer')%>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="/product/js/jquery-3.3.1.min.js"></script>
    <script src="/product/js/bootstrap.min.js"></script>
    <script src="/product/js/jquery-ui.min.js"></script>
    <script src="/product/js/jquery.countdown.min.js"></script>
    <script src="/product/js/jquery.nice-select.min.js"></script>
    <script src="/product/js/jquery.zoom.min.js"></script>
    <script src="/product/js/jquery.dd.min.js"></script>
    <script src="/product/js/jquery.slicknav.js"></script>
    <script src="/product/js/owl.carousel.min.js"></script>
    <script src="/product/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.33/dist/sweetalert2.all.min.js"></script>
    <script>
      document
        .getElementById("login-form")
        .addEventListener("submit", function (event) {
          // tat viec submit form len server
          event.preventDefault();

          // goi request login
          let email = document.getElementById("email").value;
          let password = document.getElementById("password").value;

          axios({
            method: "post",
            url: "http://localhost:3000/auth/login",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${localStorage.getItem("token")}`,
            },
            data: {
              email: email,
              password: password,
            },
          }).then((response) => {
            console.log(response);
            console.log("------------");
            console.log(response.data.messages);
            if (response.data.messages === "notfound") {
              Swal.fire("Tài khoản không tồn tại !");
            } else if (response.data.messages === "wrongpassword") {
              Swal.fire("Sai mật khẩu !");
            } else if (response.data.messages === "unconfirmed") {
              Swal.fire(
                "Tài khoản chưa được xác thực ! Vui lòng xác thực tài khoản"
              );
            } else {
              let role = response.data.role;
              console.log(role);
              if (role == "admin") {
                let token = response.data.token;
                window.localStorage.setItem("token", JSON.stringify(token));
                window.location.href = "http://localhost:3000/admin/list";
              } else {
                let token = response.data.token;
                console.log(token);
                window.localStorage.setItem("token", JSON.stringify(token));
              
                setTimeout(locationHome, 1500);
              }
            }
          });
        });

      function locationHome() {
        window.location.href = "http://localhost:3000/";
      }
    </script>
  </body>
</html>
