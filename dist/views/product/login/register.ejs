<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Fashi Template" />
    <meta name="keywords" content="Fashi, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Fashi | Template</title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css?family=Muli:300,400,500,600,700,800,900&display=swap"
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link
      rel="stylesheet"
      href="/product/css/bootstrap.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/font-awesome.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/themify-icons.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/elegant-icons.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/owl.carousel.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/nice-select.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/jquery-ui.min.css"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="/product/css/slicknav.min.css"
      type="text/css"
    />
    <link rel="stylesheet" href="/product/css/style.css" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@9.17.2/dist/sweetalert2.min.css"
    />
  </head>

  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Header Section Begin -->
    <%- include('../header/header')%>
    <!-- Header End -->

    <!-- Breadcrumb Section Begin -->
    <div class="breacrumb-section">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <div class="breadcrumb-text">
              <a href="#"><i class="fa fa-home"></i> Home</a>
              <span>Register</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Breadcrumb Form Section Begin -->

    <!-- Register Section Begin -->
    <div class="register-login-section spad">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 offset-lg-3">
            <div class="register-form">
              <h2>Register</h2>
              <form id="register-form">
                <div class="group-input">
                  <label for="username">Username *</label>
                  <input type="text" id="username" name="username" />
                  <a id="err-name"></a>
                </div>

                <div class="group-input">
                  <label for="email">Email address *</label>
                  <input type="text" id="email" name="email" />
                  <a id="err-email"></a>
                </div>

                <div class="group-input">
                  <label for="password">Password *</label>
                  <input type="password" id="password" name="password" />
                  <a id="err-password"></a>
                </div>

                <div class="group-input">
                  <label for="confirmpassword">Confirmpassword *</label>
                  <input
                    type="password"
                    id="confirmpassword"
                    name="confirmpassword"
                  />
                  <a id="err-confirmpassword"></a>
                </div>

                <button type="submit" class="site-btn register-btn">
                  REGISTER
                </button>
              </form>
              <div class="switch-login">
                <a href="/auth/login" class="or-login">Or Login</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Register Form Section End -->

    <!-- Partner Logo Section Begin -->
    <div class="partner-logo">
      <div class="container">
        <div class="logo-carousel owl-carousel">
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-1.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-2.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-3.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-4.png" alt="" />
            </div>
          </div>
          <div class="logo-item">
            <div class="tablecell-inner">
              <img src="/product/img/logo-carousel/logo-5.png" alt="" />
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Partner Logo Section End -->

    <!-- Footer Section Begin -->
    <%- include('../footer/footer')%>
    <!-- Footer Section End -->

    <!-- Js Plugins -->
    <script src="/product/js/jquery-3.3.1.min.js"></script>
    <script src="/product/js/bootstrap.min.js"></script>
    <script src="/product/js/jquery-ui.min.js"></script>
    <script src="/product/js/jquery.countdown.min.js"></script>
    <script src="/product/js/jquery.nice-select.min.js"></script>
    <script src="/product/js/jquery.zoom.min.js"></script>
    <script src="/product/js/jquery.dd.min.js"></script>
    <script src="/product/js/jquery.slicknav.js"></script>
    <script src="/product/js/owl.carousel.min.js"></script>
    <script src="/product/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.33/dist/sweetalert2.all.min.js"></script>
    <script>
      document
        .getElementById("register-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          let username = document.getElementById("username").value;
          let email = document.getElementById("email").value;
          let password = document.getElementById("password").value;
          let confirmpassword =
            document.getElementById("confirmpassword").value;
          axios({
            method: "post",
            url: "http://localhost:3000/auth/register",
            headers: {
              "Content-Type": "application/json",
            },
            data: {
              username: username,
              email: email,
              password: password,
              confirmpassword: confirmpassword,
            },
          }).then((response) => {
            // console.log(response.data);
            if (response.data.message) {
              // console.log(response.data.message);
              checkUsernam(response.data.message);
              checkEmail(response.data.message);
              checkPassword(response.data.message);
              checkConfirmpassword(response.data.message);
            } else if (response.data.emailmessages) {
              // console.log(response.data.emailmessages);
              resertHtml();
            }else if (response.data.usernamemessages){
              console.log(response.data.usernamemessages);
              resertForm();
            }
             else {
              console.log(2);
              Swal.fire(
                "Register!",
                "Your file has been register.",
                "success"
              ).then((result) => {
                console.log(result.isConfirmed);
                window.location.href = "http://localhost:3000/auth/login";
              });
            }
          });
        });

        function resertForm(){
        document.getElementById("username").value = "";
        document.getElementById("email").value = "";
        document.getElementById("password").value = "";
        document.getElementById("confirmpassword").value = "";
        document.getElementById(
          "err-name"
        ).innerHTML = ` <div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>This account has already existed !</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;
      }

      function resertHtml() {
        document.getElementById("username").value = "";
        document.getElementById("email").value = "";
        document.getElementById("password").value = "";
        document.getElementById("confirmpassword").value = "";
        document.getElementById(
          "err-email"
        ).innerHTML = ` <div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>Email already exists !</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;

      }

      function checkUsernam(response) {
        for (var i = 0; i < response.length; i++) {
          if (response[i].nameErr === "username") {
            console.log(response[i].error);
            document.getElementById(
              "err-name"
            ).innerHTML = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>${response[i].error}!</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;
          }
        }
      }

      function checkEmail(response) {
        for (var i = 0; i < response.length; i++) {
          if (response[i].nameErr === "email") {
            console.log(response[i].error);
            document.getElementById(
              "err-email"
            ).innerHTML = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>${response[i].error}!</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;
          }
        }
      }
      function checkPassword(response) {
        for (var i = 0; i < response.length; i++) {
          if (response[i].nameErr === "password") {
            console.log(response[i].error);
            document.getElementById(
              "err-password"
            ).innerHTML = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>${response[i].error}!</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;
          }
        }
      }
      function checkConfirmpassword(response) {
        for (var i = 0; i < response.length; i++) {
          if (response[i].nameErr === "confirmpassword") {
            console.log(response[i].error);
            document.getElementById(
              "err-confirmpassword"
            ).innerHTML = `<div class="alert alert-danger alert-dismissible fade show" role="alert">
         <strong>${response[i].error}!</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
          </button>
        </div`;
          }
        }
      }
    </script>
  </body>
</html>
